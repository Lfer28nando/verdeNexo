<!-- Modal del Panel de Usuario -->
<div class="modal fade" id="userPanelModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-register">
    <div class="modal-content register-card">
      <div class="modal-header user-panel-header">
        <div class="d-flex align-items-center gap-3">
          <div class="user-avatar-container">
            <img id="userAvatarModal" src="/img/default-avatar.png" alt="Avatar" class="user-avatar">
            <div class="user-status-indicator"></div>
          </div>
          <div>
            <h5 class="modal-title mb-0">¡Hola, <span id="userName" class="text-capitalize"></span>!</h5>
            <small class="text-muted">Gestiona tu cuenta</small>
          </div>
        </div>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
      </div>
      
      <div class="modal-body user-panel-body">
        <!-- Información del usuario -->
        <div class="user-info-section mb-4">
          <div class="row">
            <div class="col-6">
              <div class="user-stat">
                <span class="stat-label">Estado</span>
                <span class="stat-value text-success">Activo</span>
              </div>
            </div>
            <div class="col-6">
              <div class="user-stat">
                <span class="stat-label">Rol</span>
                <span class="stat-value" id="userRole">Cliente</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Acciones principales -->
        <div class="user-actions">
          <!-- Botón Panel Administrador (solo para admins) -->
          <div class="action-item admin-only" id="adminPanelAction" onclick="irAPanelAdmin()" style="display: none;">
            <div class="action-icon">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M12 3l8 4.5v9L12 21l-8-4.5v-9L12 3z"></path>
                <path d="M12 12l8-4.5"></path>
                <path d="M12 12v9"></path>
                <path d="M12 12L4 7.5"></path>
              </svg>
            </div>
            <div class="action-content">
              <span class="action-title">Panel Administrador</span>
              <span class="action-subtitle">Acceder a funciones administrativas</span>
            </div>
            <div class="action-arrow">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="9,18 15,12 9,6"></polyline>
              </svg>
            </div>
          </div>

          <div class="action-item" onclick="abrirEditarPerfil()">
            <div class="action-icon">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                <path d="m18.5 2.5 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
              </svg>
            </div>
            <div class="action-content">
              <span class="action-title">Editar perfil</span>
              <span class="action-subtitle">Actualiza tu información personal</span>
            </div>
            <div class="action-arrow">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="9,18 15,12 9,6"></polyline>
              </svg>
            </div>
          </div>

          <div class="action-item" onclick="abrirMetodosPago()">
            <div class="action-icon">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="1" y="4" width="22" height="16" rx="2" ry="2"></rect>
                <line x1="1" y1="10" x2="23" y2="10"></line>
              </svg>
            </div>
            <div class="action-content">
              <span class="action-title">Métodos de pago</span>
              <span class="action-subtitle">Gestiona tus tarjetas y cuentas</span>
            </div>
            <div class="action-arrow">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="9,18 15,12 9,6"></polyline>
              </svg>
            </div>
          </div>

          <div class="action-item" onclick="togglePhotoUpload()">
            <div class="action-icon">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                <circle cx="9" cy="9" r="2"></circle>
                <path d="m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21"></path>
              </svg>
            </div>
            <div class="action-content">
              <span class="action-title">Cambiar foto</span>
              <span class="action-subtitle">Actualiza tu imagen de perfil</span>
            </div>
            <div class="action-arrow">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="9,18 15,12 9,6"></polyline>
              </svg>
            </div>
          </div>

          <!-- Botón Ser Vendedor (solo para clientes) -->
          <div class="action-item cliente-only" id="vendedorAction" onclick="solicitarPermiso()">
            <div class="action-icon">
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M20 7h-9"></path>
                <path d="M14 17H5"></path>
                <circle cx="17" cy="17" r="3"></circle>
                <circle cx="7" cy="7" r="3"></circle>
              </svg>
            </div>
            <div class="action-content">
              <span class="action-title">Ser vendedor</span>
              <span class="action-subtitle">Solicita permisos de vendedor</span>
            </div>
            <div class="action-arrow">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="9,18 15,12 9,6"></polyline>
              </svg>
            </div>
          </div>
        </div>

        <!-- Upload de foto (oculto inicialmente) -->
        <div id="photoUploadSection" class="photo-upload-section" style="display: none;">
          <form id="formFoto" enctype="multipart/form-data">
            <div class="upload-area">
              <input type="file" id="fotoPerfil" class="upload-input" accept="image/*" required>
              <label for="fotoPerfil" class="upload-label">
                <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1">
                  <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                  <polyline points="7,10 12,15 17,10"></polyline>
                  <line x1="12" y1="15" x2="12" y2="3"></line>
                </svg>
                <span>Seleccionar imagen</span>
              </label>
            </div>
            <div class="upload-actions">
              <button type="button" class="btn btn-outline-secondary" onclick="togglePhotoUpload()">Cancelar</button>
              <button type="submit" class="btn btn-primary">Subir foto</button>
            </div>
          </form>
        </div>

        <!-- Separador -->
        <hr class="user-divider">

        <!-- Cerrar sesión -->
        <div class="logout-section">
          <button onclick="cerrarSesion()" class="btn-logout">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
              <polyline points="16,17 21,12 16,7"></polyline>
              <line x1="21" y1="12" x2="9" y2="12"></line>
            </svg>
            Cerrar sesión
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Modal de Editar Perfil -->
<div class="modal fade" id="editProfileModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-register">
    <div class="modal-content register-card">
      <div class="modal-header register-header">
        <h5 class="modal-title">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="me-2">
            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
            <path d="m18.5 2.5 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
          </svg>
          Editar Perfil
        </h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
      </div>
      
      <form id="editProfileForm" class="modal-body register-body">
        <div class="mb-3">
          <label for="editNombre" class="form-label">Nombre de usuario</label>
          <input type="text" class="form-control register-input" id="editNombre" name="nombre" required>
          <div class="form-text">Entre 3 y 25 caracteres. Solo letras, números y guiones bajos.</div>
        </div>

        <div class="mb-3">
          <label for="editEmail" class="form-label">Correo electrónico</label>
          <input type="email" class="form-control register-input" id="editEmail" name="email" required>
        </div>

        <div class="mb-3">
          <label for="editTelefono" class="form-label">Teléfono</label>
          <input type="tel" class="form-control register-input" id="editTelefono" name="telefono" placeholder="3001234567">
          <div class="form-text">Opcional. 10 dígitos sin espacios ni guiones.</div>
        </div>

        <div class="mb-3">
          <label for="editDireccion" class="form-label">Dirección</label>
          <input type="text" class="form-control register-input" id="editDireccion" name="direccion" placeholder="Calle 123 #45-67">
          <div class="form-text">Opcional. Dirección de entrega preferida.</div>
        </div>

        <div class="mb-3">
          <label for="editDocumento" class="form-label">Documento de identidad</label>
          <input type="text" class="form-control register-input" id="editDocumento" name="documento" placeholder="1234567890">
          <div class="form-text">Opcional. Entre 7 y 10 dígitos.</div>
        </div>

        <!-- Sección opcional para cambiar contraseña -->
        <div class="password-section">
          <div class="d-flex align-items-center justify-content-between mb-3">
            <h6 class="mb-0">Cambiar contraseña</h6>
            <button type="button" class="btn btn-sm btn-outline-secondary" id="togglePasswordSection">
              <span id="passwordToggleText">Mostrar</span>
            </button>
          </div>
          
          <div id="passwordFields" style="display: none;">
            <div class="mb-3">
              <label for="editCurrentPassword" class="form-label">Contraseña actual</label>
              <input type="password" class="form-control register-input" id="editCurrentPassword" name="currentPassword">
              <div class="form-text">Ingresa tu contraseña actual para verificar tu identidad.</div>
            </div>

            <div class="mb-3">
              <label for="editPassword" class="form-label">Nueva contraseña</label>
              <input type="password" class="form-control register-input" id="editPassword" name="password">
              <div class="form-text">Mínimo 6 caracteres con al menos un número.</div>
            </div>

            <div class="mb-3">
              <label for="editConfirmPassword" class="form-label">Confirmar nueva contraseña</label>
              <input type="password" class="form-control register-input" id="editConfirmPassword">
            </div>
          </div>
        </div>

        <!-- Sección de opciones avanzadas -->
        <div class="advanced-options mt-4 pt-3" style="border-top: 1px solid #e9ecef;">
          <div class="d-flex align-items-center justify-content-between mb-3">
            <h6 class="mb-0 text-muted">Opciones avanzadas</h6>
            <button type="button" class="btn btn-sm btn-outline-secondary" id="toggleAdvancedOptions">
              <span id="advancedToggleText">Mostrar</span>
            </button>
          </div>
          
          <div id="advancedFields" style="display: none;">
            <div class="alert alert-warning d-flex align-items-center" role="alert">
              <i class="fas fa-exclamation-triangle me-2"></i>
              <small>Las siguientes acciones son permanentes y no se pueden deshacer.</small>
            </div>
            
            <button type="button" onclick="abrirEliminarCuenta()" class="btn btn-outline-danger btn-sm w-100">
              <i class="fas fa-trash-alt me-2"></i>
              Eliminar mi cuenta permanentemente
            </button>
            
            <small class="text-muted d-block mt-2">
              Esta acción eliminará todos tus datos, historial de compras y métodos de pago de forma permanente.
            </small>
          </div>
        </div>

        <div class="modal-footer register-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
          <button type="submit" id="btnActualizar" class="btn register-submit">
            <span class="btn-text">Actualizar perfil</span>
            <span class="btn-loading" style="display: none;">
              <span class="spinner-border spinner-border-sm me-2" role="status" aria-hidden="true"></span>
              Actualizando...
            </span>
          </button>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- Modal de Métodos de Pago -->
<div class="modal fade" id="metodoPagoModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-lg">
    <div class="modal-content register-card">
      <div class="modal-header user-panel-header">
        <div class="d-flex align-items-center gap-3">
          <div class="payment-icon-container">
            <i class="fas fa-credit-card" style="font-size: 24px; color: #166534;"></i>
          </div>
          <div>
            <h5 class="modal-title mb-0">Métodos de Pago</h5>
            <small class="text-muted">Gestiona tus tarjetas y cuentas bancarias</small>
          </div>
        </div>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
      </div>
      
      <div class="modal-body user-panel-body">
        <!-- Tabs para métodos de pago -->
        <ul class="nav nav-tabs mb-4" id="paymentTabs" role="tablist">
          <li class="nav-item" role="presentation">
            <button class="nav-link active" id="cards-tab" data-bs-toggle="tab" data-bs-target="#cards" type="button" role="tab">
              <i class="fas fa-credit-card me-2"></i>Tarjetas
            </button>
          </li>
          <li class="nav-item" role="presentation">
            <button class="nav-link" id="accounts-tab" data-bs-toggle="tab" data-bs-target="#accounts" type="button" role="tab">
              <i class="fas fa-university me-2"></i>Cuentas Bancarias
            </button>
          </li>
        </ul>

        <div class="tab-content" id="paymentTabContent">
          <!-- Tab de Tarjetas -->
          <div class="tab-pane fade show active" id="cards" role="tabpanel">
            <div class="d-flex justify-content-between align-items-center mb-3">
              <h6 class="mb-0">Mis Tarjetas</h6>
              <button type="button" class="btn btn-outline-success btn-sm" onclick="abrirFormularioTarjeta()">
                <i class="fas fa-plus me-1"></i>Agregar Tarjeta
              </button>
            </div>
            
            <div id="tarjetasList" class="payment-methods-list">
              <!-- Las tarjetas se cargarán dinámicamente -->
            </div>

            <!-- Formulario para agregar tarjeta (oculto inicialmente) -->
            <div id="formularioTarjeta" style="display: none;" class="mt-4 p-3 border rounded">
              <h6 class="mb-3">Agregar Nueva Tarjeta</h6>
              <form id="formTarjeta">
                <div class="row">
                  <div class="col-md-6 mb-3">
                    <label for="tarjetaAlias" class="form-label">Alias</label>
                    <input type="text" class="form-control" id="tarjetaAlias" placeholder="Mi tarjeta principal" required>
                  </div>
                  <div class="col-md-6 mb-3">
                    <label for="tarjetaTipo" class="form-label">Tipo</label>
                    <select class="form-select" id="tarjetaTipo" required>
                      <option value="">Seleccionar...</option>
                      <option value="credito">Crédito</option>
                      <option value="debito">Débito</option>
                    </select>
                  </div>
                </div>
                <div class="mb-3">
                  <label for="tarjetaNumero" class="form-label">Número de tarjeta</label>
                  <input type="text" class="form-control" id="tarjetaNumero" placeholder="1234 5678 9012 3456" maxlength="19" required>
                </div>
                <div class="row">
                  <div class="col-md-6 mb-3">
                    <label for="tarjetaTitular" class="form-label">Titular</label>
                    <input type="text" class="form-control" id="tarjetaTitular" placeholder="Nombre como aparece en la tarjeta" required>
                  </div>
                  <div class="col-md-3 mb-3">
                    <label for="tarjetaVencimiento" class="form-label">MM/YY</label>
                    <input type="text" class="form-control" id="tarjetaVencimiento" placeholder="12/28" maxlength="5" required>
                  </div>
                  <div class="col-md-3 mb-3">
                    <label for="tarjetaBanco" class="form-label">Banco</label>
                    <input type="text" class="form-control" id="tarjetaBanco" placeholder="Bancolombia">
                  </div>
                </div>
                <div class="d-flex gap-2">
                  <button type="submit" class="btn btn-success btn-sm">Agregar Tarjeta</button>
                  <button type="button" class="btn btn-secondary btn-sm" onclick="cancelarFormularioTarjeta()">Cancelar</button>
                </div>
              </form>
            </div>
          </div>

          <!-- Tab de Cuentas Bancarias -->
          <div class="tab-pane fade" id="accounts" role="tabpanel">
            <div class="d-flex justify-content-between align-items-center mb-3">
              <h6 class="mb-0">Mis Cuentas Bancarias</h6>
              <button type="button" class="btn btn-outline-success btn-sm" onclick="abrirFormularioCuenta()">
                <i class="fas fa-plus me-1"></i>Agregar Cuenta
              </button>
            </div>
            
            <div id="cuentasList" class="payment-methods-list">
              <!-- Las cuentas se cargarán dinámicamente -->
            </div>

            <!-- Formulario para agregar cuenta bancaria (oculto inicialmente) -->
            <div id="formularioCuenta" style="display: none;" class="mt-4 p-3 border rounded">
              <h6 class="mb-3">Agregar Nueva Cuenta Bancaria</h6>
              <form id="formCuenta">
                <div class="row">
                  <div class="col-md-6 mb-3">
                    <label for="cuentaAlias" class="form-label">Alias</label>
                    <input type="text" class="form-control" id="cuentaAlias" placeholder="Cuenta principal" required>
                  </div>
                  <div class="col-md-6 mb-3">
                    <label for="cuentaBanco" class="form-label">Banco</label>
                    <input type="text" class="form-control" id="cuentaBanco" placeholder="Bancolombia" required>
                  </div>
                </div>
                <div class="row">
                  <div class="col-md-6 mb-3">
                    <label for="cuentaTipo" class="form-label">Tipo de cuenta</label>
                    <select class="form-select" id="cuentaTipo" required>
                      <option value="">Seleccionar...</option>
                      <option value="ahorros">Ahorros</option>
                      <option value="corriente">Corriente</option>
                    </select>
                  </div>
                  <div class="col-md-6 mb-3">
                    <label for="cuentaNumero" class="form-label">Número de cuenta</label>
                    <input type="text" class="form-control" id="cuentaNumero" placeholder="1234567890" required>
                  </div>
                </div>
                <div class="mb-3">
                  <label for="cuentaTitular" class="form-label">Titular</label>
                  <input type="text" class="form-control" id="cuentaTitular" placeholder="Nombre del titular" required>
                </div>
                <div class="d-flex gap-2">
                  <button type="submit" class="btn btn-success btn-sm">Agregar Cuenta</button>
                  <button type="button" class="btn btn-secondary btn-sm" onclick="cancelarFormularioCuenta()">Cancelar</button>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Modal de Recuperar Contraseña - Solicitar -->
<div class="modal fade" id="forgotPasswordModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content register-card">
      <div class="modal-header register-header">
        <div class="d-flex align-items-center gap-3">
          <div class="register-logo"></div>
          <div>
            <h5 class="modal-title mb-0">Recuperar Contraseña</h5>
            <small class="opacity-75">Ingresa tu email para enviarte un código de verificación</small>
          </div>
        </div>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body register-body">
        <form id="forgotPasswordForm" onsubmit="return solicitarResetPassword(event)">
          <div class="mb-3">
            <label for="forgotEmail" class="form-label">
              <i class="fas fa-envelope me-2"></i>Correo electrónico
            </label>
            <input 
              type="email" 
              class="form-control register-input" 
              id="forgotEmail" 
              placeholder="tu@email.com"
              required
            >
            <div class="form-text">
              <i class="fas fa-info-circle me-1"></i>
              Te enviaremos un código de 6 dígitos para restablecer tu contraseña
            </div>
          </div>
          
          <button type="submit" class="btn register-submit w-100" id="btnSolicitarReset">
            <span class="btn-text">
              <i class="fas fa-paper-plane me-2"></i>Enviar código
            </span>
            <span class="btn-loading" style="display: none;">
              <span class="spinner-border spinner-border-sm me-2" role="status"></span>
              Enviando...
            </span>
          </button>
        </form>
      </div>
      <div class="register-footer">
        <div class="text-center">
          <small class="text-muted">
            ¿Recordaste tu contraseña? 
            <a href="#" class="link-dark" onclick="abrirLogin()">Inicia sesión</a>
          </small>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Modal de Recuperar Contraseña - Confirmar -->
<div class="modal fade" id="confirmResetModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content register-card">
      <div class="modal-header register-header">
        <div class="d-flex align-items-center gap-3">
          <div class="register-logo"></div>
          <div>
            <h5 class="modal-title mb-0">Confirmar Nueva Contraseña</h5>
            <small class="opacity-75">Ingresa el código que recibiste y tu nueva contraseña</small>
          </div>
        </div>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body register-body">
        <form id="confirmResetForm" onsubmit="return confirmarResetPassword(event)">
          <div class="mb-3">
            <label for="codigoReset" class="form-label">
              <i class="fas fa-key me-2"></i>Código de verificación
            </label>
            <input 
              type="text" 
              class="form-control register-input text-center" 
              id="codigoReset" 
              placeholder="123456"
              maxlength="6"
              pattern="[0-9]{6}"
              required
              style="font-family: 'Courier New', monospace; letter-spacing: 2px; font-size: 1.2rem;"
            >
            <div class="form-text">
              <i class="fas fa-info-circle me-1"></i>
              Revisa tu bandeja de entrada y spam
            </div>
          </div>
          
          <div class="mb-3">
            <label for="nuevaPassword" class="form-label">
              <i class="fas fa-lock me-2"></i>Nueva contraseña
            </label>
            <input 
              type="password" 
              class="form-control register-input" 
              id="nuevaPassword" 
              placeholder="Mínimo 6 caracteres con al menos 1 número"
              required
            >
          </div>
          
          <div class="mb-3">
            <label for="confirmarPassword" class="form-label">
              <i class="fas fa-lock me-2"></i>Confirmar nueva contraseña
            </label>
            <input 
              type="password" 
              class="form-control register-input" 
              id="confirmarPassword" 
              placeholder="Repite la nueva contraseña"
              required
            >
          </div>
          
          <button type="submit" class="btn register-submit w-100" id="btnConfirmarReset">
            <span class="btn-text">
              <i class="fas fa-check me-2"></i>Cambiar contraseña
            </span>
            <span class="btn-loading" style="display: none;">
              <span class="spinner-border spinner-border-sm me-2" role="status"></span>
              Cambiando...
            </span>
          </button>
        </form>
      </div>
      <div class="register-footer">
        <div class="text-center">
          <small class="text-muted">
            ¿No recibiste el código? 
            <a href="#" class="link-dark" onclick="abrirRecuperarPassword()">Solicitar nuevo código</a>
          </small>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Modal de Eliminar Cuenta - Solicitar -->
<div class="modal fade" id="deleteAccountModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content register-card">
      <div class="modal-header" style="background: linear-gradient(135deg, #dc3545, #c82333); color: white;">
        <div class="d-flex align-items-center gap-3">
          <div style="width: 24px; height: 24px; background: white; border-radius: 50%; display: flex; align-items: center; justify-content: center;">
            <i class="fas fa-exclamation-triangle" style="color: #dc3545; font-size: 12px;"></i>
          </div>
          <div>
            <h5 class="modal-title mb-0">Eliminar mi cuenta</h5>
            <small class="opacity-75">Esta acción desactivará permanentemente tu cuenta</small>
          </div>
        </div>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body register-body">
        <div class="alert alert-danger" role="alert">
          <i class="fas fa-exclamation-triangle me-2"></i>
          <strong>¡Atención!</strong> Esta acción es irreversible. Tu cuenta será desactivada permanentemente y no podrás recuperarla.
        </div>
        
        <div class="mb-3">
          <h6>Esto significa que:</h6>
          <ul class="text-muted small">
            <li>No podrás iniciar sesión nuevamente</li>
            <li>Perderás acceso a todos tus datos</li>
            <li>Tus métodos de pago serán eliminados</li>
            <li>Tu historial de compras no será accesible</li>
          </ul>
        </div>

        <form id="deleteAccountForm" onsubmit="return solicitarEliminarCuenta(event)">
          <div class="mb-3">
            <label for="deletePassword" class="form-label">
              <i class="fas fa-lock me-2"></i>Confirma tu contraseña actual
            </label>
            <input 
              type="password" 
              class="form-control register-input" 
              id="deletePassword" 
              placeholder="Tu contraseña actual"
              required
            >
            <div class="form-text">
              <i class="fas fa-info-circle me-1"></i>
              Te enviaremos un código de verificación para confirmar la eliminación
            </div>
          </div>
          
          <div class="mb-3">
            <div class="form-check">
              <input class="form-check-input" type="checkbox" id="confirmDelete" required>
              <label class="form-check-label" for="confirmDelete">
                Entiendo que esta acción es irreversible y deseo eliminar mi cuenta
              </label>
            </div>
          </div>
          
          <button type="submit" class="btn w-100" id="btnSolicitarEliminar" style="background: linear-gradient(135deg, #dc3545, #c82333); color: white;">
            <span class="btn-text">
              <i class="fas fa-paper-plane me-2"></i>Enviar código de confirmación
            </span>
            <span class="btn-loading" style="display: none;">
              <span class="spinner-border spinner-border-sm me-2" role="status"></span>
              Enviando...
            </span>
          </button>
        </form>
      </div>
      <div class="register-footer">
        <div class="text-center">
          <small class="text-muted">
            ¿Cambiaiste de opinión? 
            <a href="#" class="link-dark" data-bs-dismiss="modal">Cancelar y volver</a>
          </small>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Modal de Eliminar Cuenta - Confirmar -->
<div class="modal fade" id="confirmDeleteModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content register-card">
      <div class="modal-header" style="background: linear-gradient(135deg, #dc3545, #c82333); color: white;">
        <div class="d-flex align-items-center gap-3">
          <div style="width: 24px; height: 24px; background: white; border-radius: 50%; display: flex; align-items: center; justify-content: center;">
            <i class="fas fa-key" style="color: #dc3545; font-size: 12px;"></i>
          </div>
          <div>
            <h5 class="modal-title mb-0">Confirmación final</h5>
            <small class="opacity-75">Ingresa el código para eliminar tu cuenta</small>
          </div>
        </div>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body register-body">
        <div class="alert alert-warning" role="alert">
          <i class="fas fa-clock me-2"></i>
          Hemos enviado un código de verificación a tu email. Tienes <strong>10 minutos</strong> para completar este proceso.
        </div>

        <form id="confirmDeleteForm" onsubmit="return confirmarEliminarCuenta(event)">
          <div class="mb-3">
            <label for="codigoEliminar" class="form-label">
              <i class="fas fa-key me-2"></i>Código de verificación
            </label>
            <input 
              type="text" 
              class="form-control register-input text-center" 
              id="codigoEliminar" 
              placeholder="123456"
              maxlength="6"
              pattern="[0-9]{6}"
              required
              style="font-family: 'Courier New', monospace; letter-spacing: 2px; font-size: 1.2rem;"
            >
            <div class="form-text">
              <i class="fas fa-info-circle me-1"></i>
              Revisa tu bandeja de entrada y spam
            </div>
          </div>
          
          <div class="mb-4">
            <div class="p-3 bg-light border-start border-4 border-danger">
              <strong class="text-danger">Última oportunidad</strong>
              <p class="mb-0 text-muted small mt-1">
                Una vez confirmado, tu cuenta será desactivada inmediatamente y no podrás recuperarla.
              </p>
            </div>
          </div>
          
          <button type="submit" class="btn w-100" id="btnConfirmarEliminar" style="background: linear-gradient(135deg, #dc3545, #c82333); color: white;">
            <span class="btn-text">
              <i class="fas fa-trash me-2"></i>Eliminar mi cuenta definitivamente
            </span>
            <span class="btn-loading" style="display: none;">
              <span class="spinner-border spinner-border-sm me-2" role="status"></span>
              Eliminando...
            </span>
          </button>
        </form>
      </div>
      <div class="register-footer">
        <div class="text-center">
          <small class="text-muted">
            ¿No recibiste el código? 
            <a href="#" class="link-dark" onclick="abrirEliminarCuenta()">Solicitar nuevo código</a>
          </small>
        </div>
      </div>
    </div>
  </div>
</div>
