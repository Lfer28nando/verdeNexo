<%- include('../partials/header') %>
<link rel="stylesheet" href="/css/catalogo.styles.css">

<div class="catalog-container">
    <!-- Header del Catálogo -->
    <section class="catalog-header">
        <div class="container">
            <div class="row justify-content-center text-center">
                <div class="col-lg-8">
                    <h1 class="catalog-title">Nuestro Catálogo de Plantas</h1>
                    <p class="catalog-subtitle">Descubre nuestra colección completa de plantas premium, cuidadosamente seleccionadas para transformar tu espacio</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Contenido Principal -->
    <div class="container py-5">
        <div class="row">
            <!-- Sidebar de Filtros (Desktop) -->
            <aside class="col-lg-3 d-none d-lg-block" aria-label="Filtros de catálogo">
                <div class="filters-sidebar">
                    <div class="filter-group">
                        <h5 class="filter-title">Categorías</h5>
                        <div class="checkbox-custom">
                            <input type="checkbox" id="cat-interior" value="interior">
                            <label for="cat-interior">Plantas de Interior</label>
                        </div>
                        <div class="checkbox-custom">
                            <input type="checkbox" id="cat-exterior" value="exterior">
                            <label for="cat-exterior">Plantas de Exterior</label>
                        </div>
                        <div class="checkbox-custom">
                            <input type="checkbox" id="cat-aromaticas" value="aromaticas">
                            <label for="cat-aromaticas">Plantas Aromáticas</label>
                        </div>
                        <div class="checkbox-custom">
                            <input type="checkbox" id="cat-suculentas" value="suculentas">
                            <label for="cat-suculentas">Suculentas y Cactus</label>
                        </div>
                    </div>
                    <div class="filter-group">
                        <h5 class="filter-title">Disponibilidad</h5>
                        <div class="checkbox-custom">
                            <input type="checkbox" id="disp-disponible" value="true" checked>
                            <label for="disp-disponible">Disponible</label>
                        </div>
                        <div class="checkbox-custom">
                            <input type="checkbox" id="disp-agotado" value="false">
                            <label for="disp-agotado">Agotado</label>
                        </div>
                    </div>
                    <div class="filter-group">
                        <h5 class="filter-title">Etiquetas</h5>
                        <div class="checkbox-custom">
                            <input type="checkbox" id="tag-destacado" value="destacado">
                            <label for="tag-destacado">Destacado</label>
                        </div>
                        <div class="checkbox-custom">
                            <input type="checkbox" id="tag-nuevo" value="nuevo">
                            <label for="tag-nuevo">Nuevo</label>
                        </div>
                        <div class="checkbox-custom">
                            <input type="checkbox" id="tag-oferta" value="oferta">
                            <label for="tag-oferta">En Oferta</label>
                        </div>
                    </div>
                </div>
            </aside>

            <!-- Contenido Principal -->
            <main class="col-lg-9" aria-label="Listado de productos">
                <!-- Barra de Filtros -->
                <div class="filters-bar shadow-sm rounded-3 mb-4">
                    <div class="row align-items-center g-3">
                        <div class="col-md-4">
                            <input type="text" class="search-input" id="searchInput" placeholder="Buscar plantas..." aria-label="Buscar plantas">
                        </div>
                        <div class="col-md-2">
                            <select class="filter-select" id="sortSelect" aria-label="Ordenar por">
                                <option value="nombre">Nombre A-Z</option>
                                <option value="precioBase">Precio Menor</option>
                                <option value="-precioBase">Precio Mayor</option>
                                <option value="-createdAt">Más Recientes</option>
                                <option value="createdAt">Más Antiguos</option>
                            </select>
                        </div>
                        <div class="col-md-3">
                            <div class="price-range">
                                <input type="number" class="price-input" id="minPrice" placeholder="Min" aria-label="Precio mínimo">
                                <span>-</span>
                                <input type="number" class="price-input" id="maxPrice" placeholder="Max" aria-label="Precio máximo">
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="d-flex gap-2">
                                <button class="btn btn-outline-success flex-fill" onclick="toggleFilters()" aria-label="Mostrar filtros avanzados">
                                    <i class="fas fa-filter me-1"></i>Filtros
                                </button>
                                <button class="clear-filters" onclick="clearFilters()" aria-label="Limpiar filtros">
                                    <i class="fas fa-times me-1"></i>Limpiar
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Resultados y Estadísticas -->
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <div id="resultsCount" class="text-muted">Cargando productos...</div>
                    <div class="d-flex gap-2">
                        <button class="btn btn-outline-secondary btn-sm" onclick="toggleView('grid')" id="gridView" aria-label="Vista de cuadrícula" title="Vista de cuadrícula">
                            <i class="fas fa-th"></i>
                        </button>
                        <button class="btn btn-outline-secondary btn-sm" onclick="toggleView('list')" id="listView" aria-label="Vista de lista" title="Vista de lista">
                            <i class="fas fa-list"></i>
                        </button>
                    </div>
                </div>

                <!-- Grid de Productos -->
                <section class="products-grid" id="productsGrid" aria-live="polite">
                    <div class="loading-spinner">
                        <div class="spinner-custom"></div>
                    </div>
                </section>

                <!-- Paginación -->
                <nav class="pagination-container" aria-label="Paginación de productos">
                    <div class="pagination-custom" id="paginationControls">
                        <!-- Controles de paginación se generan dinámicamente -->
                    </div>
                </nav>
            </main>
        </div>
    </div>
</div>

<!-- Modal de Vista Rápida -->
<div class="modal fade quick-view-modal" id="quickViewModal" tabindex="-1" aria-labelledby="quickViewTitle" aria-modal="true" role="dialog">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="quickViewTitle">Vista Rápida del Producto</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-md-6">
                        <img id="quickViewImage" src="" alt="Imagen principal del producto" class="quick-view-image">
                        <div class="quick-view-thumbnails" id="quickViewThumbnails" aria-label="Miniaturas de producto">
                            <!-- Miniaturas se generan dinámicamente -->
                        </div>
                    </div>
                    <div class="col-md-6 quick-view-details">
                        <h3 id="quickViewTitle"></h3>
                        <div class="quick-view-price" id="quickViewPrice"></div>
                        <div class="product-rating mb-3">
                            <div class="product-stars" id="quickViewStars" title="Calificación promedio">
                                ★★★★☆
                            </div>
                            <span class="product-rating-count" aria-label="Cantidad de calificaciones">(4.5)</span>
                        </div>
                        <div class="quick-view-description" id="quickViewDescription"></div>
                        <!-- Reseñas en vista rápida -->
                        <div class="mt-3" id="quickViewReviews">
                            <!-- Las reseñas se cargarán dinámicamente -->
                        </div>
                        <div class="quantity-selector" aria-label="Selector de cantidad">
                            <button class="quantity-btn" onclick="changeQuantity(-1)" aria-label="Disminuir cantidad">-</button>
                            <input type="number" class="quantity-input" id="quantityInput" value="1" min="1" max="99" aria-label="Cantidad">
                            <button class="quantity-btn" onclick="changeQuantity(1)" aria-label="Aumentar cantidad">+</button>
                        </div>
                        <div class="d-flex gap-2">
                            <button class="btn btn-add-cart flex-fill" onclick="addToCartFromModal()" aria-label="Agregar al carrito">
                                <i class="fas fa-cart-plus me-2"></i>Agregar al Carrito
                            </button>
                            <button class="btn btn-outline-success" onclick="viewFullDetails()" aria-label="Ver detalles">
                                <i class="fas fa-eye me-2"></i>Ver Detalles
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Modal de Calificación -->
<div class="modal fade rating-modal" id="ratingModal" tabindex="-1" aria-labelledby="ratingProductName" aria-modal="true" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="ratingProductName">Calificar Producto</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
            </div>
            <div class="modal-body text-center">
                <h6 id="ratingProductName" class="mb-3"></h6>
                <div class="rating-stars" id="ratingStars" aria-label="Selecciona una calificación">
                    <span class="rating-star" data-rating="1" title="1 estrella">★</span>
                    <span class="rating-star" data-rating="2" title="2 estrellas">★</span>
                    <span class="rating-star" data-rating="3" title="3 estrellas">★</span>
                    <span class="rating-star" data-rating="4" title="4 estrellas">★</span>
                    <span class="rating-star" data-rating="5" title="5 estrellas">★</span>
                </div>
                <p class="text-muted mb-3" id="ratingText">Selecciona una calificación</p>
                <textarea
                    class="rating-input"
                    id="ratingComment"
                    placeholder="Deja un comentario (opcional)..."
                    maxlength="500"
                    aria-label="Comentario de calificación"
                ></textarea>
                <div class="mt-3">
                    <small class="text-muted">Tu calificación será pública y ayudará a otros usuarios.</small>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                <button type="button" class="btn btn-success" id="submitRating" disabled>
                    <i class="fas fa-star me-1"></i>Calificar
                </button>
            </div>
        </div>
    </div>
</div>

<script type="module" src="/js/catalogo.functions.js"></script>
<%- include('../partials/footer') %>